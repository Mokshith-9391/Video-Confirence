{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\MOKSHITH\\\\OneDrive\\\\Desktop\\\\VIDEO CONFERENCE\\\\frontend\\\\src\\\\utils\\\\withAuth.jsx\";\nimport React, { useEffect, useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport axios from 'axios';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst withAuth = Component => {\n  var _s = $RefreshSig$();\n  return _s(props => {\n    _s();\n    const navigate = useNavigate();\n    const [loading, setLoading] = useState(true);\n    useEffect(() => {\n      const checkAuth = async () => {\n        const token = localStorage.getItem('token');\n        if (!token) {\n          navigate('/auth');\n          return;\n        }\n        try {\n          const response = await axios.get('http://localhost:8000/api/validate-token', {\n            headers: {\n              'Authorization': `Bearer ${token}`\n            }\n          });\n\n          // If the token is valid, set the user and stop loading\n          // You might have a user context or Redux store to set the user\n          setLoading(false);\n        } catch (error) {\n          console.error(\"Authentication failed:\", error);\n          if (error.response && error.response.status === 400) {\n            localStorage.removeItem('token');\n            navigate('/auth');\n          } else {\n            navigate('/auth');\n          }\n        }\n      };\n      checkAuth();\n    }, [navigate]);\n    if (loading) {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        children: \"Loading...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 46,\n        columnNumber: 20\n      }, this);\n    }\n    return /*#__PURE__*/_jsxDEV(Component, {\n      ...props\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 49,\n      columnNumber: 16\n    }, this);\n  }, \"4iP38C2EBbHdivfXoigmDQD/8fs=\", false, function () {\n    return [useNavigate];\n  });\n};\nexport default withAuth;","map":{"version":3,"names":["React","useEffect","useState","useNavigate","axios","jsxDEV","_jsxDEV","withAuth","Component","_s","$RefreshSig$","props","navigate","loading","setLoading","checkAuth","token","localStorage","getItem","response","get","headers","error","console","status","removeItem","children","fileName","_jsxFileName","lineNumber","columnNumber"],"sources":["C:/Users/MOKSHITH/OneDrive/Desktop/VIDEO CONFERENCE/frontend/src/utils/withAuth.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport axios from 'axios';\n\nconst withAuth = (Component) => {\n    return (props) => {\n        const navigate = useNavigate();\n        const [loading, setLoading] = useState(true);\n\n        useEffect(() => {\n            const checkAuth = async () => {\n                const token = localStorage.getItem('token');\n                \n                if (!token) {\n                    navigate('/auth');\n                    return;\n                }\n\n                try {\n                    const response = await axios.get('http://localhost:8000/api/validate-token', {\n                        headers: {\n                            'Authorization': `Bearer ${token}`\n                        }\n                    });\n\n                    // If the token is valid, set the user and stop loading\n                    // You might have a user context or Redux store to set the user\n                    setLoading(false);\n\n                } catch (error) {\n                    console.error(\"Authentication failed:\", error);\n\n                    if (error.response && error.response.status === 400) {\n                        localStorage.removeItem('token');\n                        navigate('/auth');\n                    } else {\n                        navigate('/auth');\n                    }\n                }\n            };\n\n            checkAuth();\n        }, [navigate]);\n\n        if (loading) {\n            return <div>Loading...</div>;\n        }\n\n        return <Component {...props} />;\n    };\n};\n\nexport default withAuth;"],"mappings":";AAAA,OAAOA,KAAK,IAAIC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAClD,SAASC,WAAW,QAAQ,kBAAkB;AAC9C,OAAOC,KAAK,MAAM,OAAO;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAE1B,MAAMC,QAAQ,GAAIC,SAAS,IAAK;EAAA,IAAAC,EAAA,GAAAC,YAAA;EAC5B,OAAAD,EAAA,CAAQE,KAAK,IAAK;IAAAF,EAAA;IACd,MAAMG,QAAQ,GAAGT,WAAW,CAAC,CAAC;IAC9B,MAAM,CAACU,OAAO,EAAEC,UAAU,CAAC,GAAGZ,QAAQ,CAAC,IAAI,CAAC;IAE5CD,SAAS,CAAC,MAAM;MACZ,MAAMc,SAAS,GAAG,MAAAA,CAAA,KAAY;QAC1B,MAAMC,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;QAE3C,IAAI,CAACF,KAAK,EAAE;UACRJ,QAAQ,CAAC,OAAO,CAAC;UACjB;QACJ;QAEA,IAAI;UACA,MAAMO,QAAQ,GAAG,MAAMf,KAAK,CAACgB,GAAG,CAAC,0CAA0C,EAAE;YACzEC,OAAO,EAAE;cACL,eAAe,EAAG,UAASL,KAAM;YACrC;UACJ,CAAC,CAAC;;UAEF;UACA;UACAF,UAAU,CAAC,KAAK,CAAC;QAErB,CAAC,CAAC,OAAOQ,KAAK,EAAE;UACZC,OAAO,CAACD,KAAK,CAAC,wBAAwB,EAAEA,KAAK,CAAC;UAE9C,IAAIA,KAAK,CAACH,QAAQ,IAAIG,KAAK,CAACH,QAAQ,CAACK,MAAM,KAAK,GAAG,EAAE;YACjDP,YAAY,CAACQ,UAAU,CAAC,OAAO,CAAC;YAChCb,QAAQ,CAAC,OAAO,CAAC;UACrB,CAAC,MAAM;YACHA,QAAQ,CAAC,OAAO,CAAC;UACrB;QACJ;MACJ,CAAC;MAEDG,SAAS,CAAC,CAAC;IACf,CAAC,EAAE,CAACH,QAAQ,CAAC,CAAC;IAEd,IAAIC,OAAO,EAAE;MACT,oBAAOP,OAAA;QAAAoB,QAAA,EAAK;MAAU;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAK,CAAC;IAChC;IAEA,oBAAOxB,OAAA,CAACE,SAAS;MAAA,GAAKG;IAAK;MAAAgB,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAG,CAAC;EACnC,CAAC;IAAA,QA3CoB3B,WAAW;EAAA;AA4CpC,CAAC;AAED,eAAeI,QAAQ"},"metadata":{},"sourceType":"module","externalDependencies":[]}