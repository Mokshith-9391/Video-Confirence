{"ast":null,"code":"import _objectSpread from\"C:/Users/MOKSHITH/OneDrive/Desktop/VIDEO CONFERENCE/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useEffect,useState}from'react';import{useNavigate}from'react-router-dom';import axios from'axios';import{jsx as _jsx}from\"react/jsx-runtime\";const withAuth=Component=>{return props=>{const navigate=useNavigate();const[loading,setLoading]=useState(true);useEffect(()=>{const checkAuth=async()=>{const token=localStorage.getItem('token');if(!token){navigate('/auth');return;}try{const response=await axios.get('http://localhost:8000/api/validate-token',{headers:{'Authorization':\"Bearer \".concat(token)}});// If the token is valid, set the user and stop loading\n// You might have a user context or Redux store to set the user\nsetLoading(false);}catch(error){console.error(\"Authentication failed:\",error);if(error.response&&error.response.status===400){localStorage.removeItem('token');navigate('/auth');}else{navigate('/auth');}}};checkAuth();},[navigate]);if(loading){return/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"});}return/*#__PURE__*/_jsx(Component,_objectSpread({},props));};};export default withAuth;","map":{"version":3,"names":["React","useEffect","useState","useNavigate","axios","jsx","_jsx","withAuth","Component","props","navigate","loading","setLoading","checkAuth","token","localStorage","getItem","response","get","headers","concat","error","console","status","removeItem","children","_objectSpread"],"sources":["C:/Users/MOKSHITH/OneDrive/Desktop/VIDEO CONFERENCE/frontend/src/utils/withAuth.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport axios from 'axios';\n\nconst withAuth = (Component) => {\n    return (props) => {\n        const navigate = useNavigate();\n        const [loading, setLoading] = useState(true);\n\n        useEffect(() => {\n            const checkAuth = async () => {\n                const token = localStorage.getItem('token');\n                \n                if (!token) {\n                    navigate('/auth');\n                    return;\n                }\n\n                try {\n                    const response = await axios.get('http://localhost:8000/api/validate-token', {\n                        headers: {\n                            'Authorization': `Bearer ${token}`\n                        }\n                    });\n\n                    // If the token is valid, set the user and stop loading\n                    // You might have a user context or Redux store to set the user\n                    setLoading(false);\n\n                } catch (error) {\n                    console.error(\"Authentication failed:\", error);\n\n                    if (error.response && error.response.status === 400) {\n                        localStorage.removeItem('token');\n                        navigate('/auth');\n                    } else {\n                        navigate('/auth');\n                    }\n                }\n            };\n\n            checkAuth();\n        }, [navigate]);\n\n        if (loading) {\n            return <div>Loading...</div>;\n        }\n\n        return <Component {...props} />;\n    };\n};\n\nexport default withAuth;"],"mappings":"iJAAA,MAAO,CAAAA,KAAK,EAAIC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAClD,OAASC,WAAW,KAAQ,kBAAkB,CAC9C,MAAO,CAAAC,KAAK,KAAM,OAAO,CAAC,OAAAC,GAAA,IAAAC,IAAA,yBAE1B,KAAM,CAAAC,QAAQ,CAAIC,SAAS,EAAK,CAC5B,MAAQ,CAAAC,KAAK,EAAK,CACd,KAAM,CAAAC,QAAQ,CAAGP,WAAW,CAAC,CAAC,CAC9B,KAAM,CAACQ,OAAO,CAAEC,UAAU,CAAC,CAAGV,QAAQ,CAAC,IAAI,CAAC,CAE5CD,SAAS,CAAC,IAAM,CACZ,KAAM,CAAAY,SAAS,CAAG,KAAAA,CAAA,GAAY,CAC1B,KAAM,CAAAC,KAAK,CAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAE3C,GAAI,CAACF,KAAK,CAAE,CACRJ,QAAQ,CAAC,OAAO,CAAC,CACjB,OACJ,CAEA,GAAI,CACA,KAAM,CAAAO,QAAQ,CAAG,KAAM,CAAAb,KAAK,CAACc,GAAG,CAAC,0CAA0C,CAAE,CACzEC,OAAO,CAAE,CACL,eAAe,WAAAC,MAAA,CAAYN,KAAK,CACpC,CACJ,CAAC,CAAC,CAEF;AACA;AACAF,UAAU,CAAC,KAAK,CAAC,CAErB,CAAE,MAAOS,KAAK,CAAE,CACZC,OAAO,CAACD,KAAK,CAAC,wBAAwB,CAAEA,KAAK,CAAC,CAE9C,GAAIA,KAAK,CAACJ,QAAQ,EAAII,KAAK,CAACJ,QAAQ,CAACM,MAAM,GAAK,GAAG,CAAE,CACjDR,YAAY,CAACS,UAAU,CAAC,OAAO,CAAC,CAChCd,QAAQ,CAAC,OAAO,CAAC,CACrB,CAAC,IAAM,CACHA,QAAQ,CAAC,OAAO,CAAC,CACrB,CACJ,CACJ,CAAC,CAEDG,SAAS,CAAC,CAAC,CACf,CAAC,CAAE,CAACH,QAAQ,CAAC,CAAC,CAEd,GAAIC,OAAO,CAAE,CACT,mBAAOL,IAAA,QAAAmB,QAAA,CAAK,YAAU,CAAK,CAAC,CAChC,CAEA,mBAAOnB,IAAA,CAACE,SAAS,CAAAkB,aAAA,IAAKjB,KAAK,CAAG,CAAC,CACnC,CAAC,CACL,CAAC,CAED,cAAe,CAAAF,QAAQ"},"metadata":{},"sourceType":"module","externalDependencies":[]}